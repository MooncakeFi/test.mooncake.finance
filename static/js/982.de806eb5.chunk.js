"use strict";(self.webpackChunkdice_game=self.webpackChunkdice_game||[]).push([[982],{4982:function(e,t,n){n.r(t),n.d(t,{ParticleDelegateProvider:function(){return ie},ParticleProvider:function(){return re}});var r,i,a,s,u,c,o,h,f,p,d,l,v,m,g,y=n(97326),b=n(74165),k=n(15671),w=n(43144),x=n(60136),Z=n(29388),_=n(98737),P=n(37762),C=n(3043),j=n(92810),I=n(92617),T=n(19778),q=n(47465),S=n(31243),E=Object.defineProperty,D=Object.defineProperties,O=Object.getOwnPropertyDescriptor,A=Object.getOwnPropertyDescriptors,L=Object.getOwnPropertyNames,R=Object.getOwnPropertySymbols,N=Object.prototype.hasOwnProperty,M=Object.prototype.propertyIsEnumerable,B=function(e,t,n){return t in e?E(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n},H=function(e,t){for(var n in t||(t={}))N.call(t,n)&&B(e,n,t[n]);if(R){var r,i=(0,P.Z)(R(t));try{for(i.s();!(r=i.n()).done;){n=r.value;M.call(t,n)&&B(e,n,t[n])}}catch(a){i.e(a)}finally{i.f()}}return e},W=function(e){return function(e,t,n,r){if(t&&"object"===typeof t||"function"===typeof t){var i,a=(0,P.Z)(L(t));try{var s=function(){var a=i.value;N.call(e,a)||a===n||E(e,a,{get:function(){return t[a]},enumerable:!(r=O(t,a))||r.enumerable})};for(a.s();!(i=a.n()).done;)s()}catch(u){a.e(u)}finally{a.f()}}return e}(E({},"__esModule",{value:!0}),e)},K=function(e,t,n){return new Promise((function(r,i){var a=function(e){try{u(n.next(e))}catch(t){i(t)}},s=function(e){try{u(n.throw(e))}catch(t){i(t)}},u=function(e){return e.done?r(e.value):Promise.resolve(e.value).then(a,s)};u((n=n.apply(e,t)).next())}))},U={};!function(e,t){for(var n in t)E(e,n,{get:t[n],enumerable:!0})}(U,{default:function(){return g},dependencies:function(){return d},devDependencies:function(){return l},files:function(){return a},gitHead:function(){return m},license:function(){return h},main:function(){return u},module:function(){return c},name:function(){return r},peerDependencies:function(){return p},publishConfig:function(){return f},scripts:function(){return v},type:function(){return s},types:function(){return o},version:function(){return i}});var z,J,V=(z={"package.json":function(){g={name:r="@particle-network/provider",version:i="1.2.1",files:a=["es","lib","LICENSE"],type:s="module",main:u="lib/index.js",module:c="es/index.js",types:o="lib/types/index.d.ts",license:h="Apache-2.0",publishConfig:f={access:"public"},peerDependencies:p={"@particle-network/auth":"*"},dependencies:d={"@particle-network/chains":"*",axios:"^1.3.6",uuid:"^8.3.2"},devDependencies:l={"@particle-network/auth":"^1.2.2","@types/uuid":"^8.3.4","ts-loader":"^9.3.1","webpack-cli":"^4.10.0"},scripts:v={package:'shx echo \'{ "type": "commonjs" }\' > lib/package.json',build:"yarn clean && node ./esBuild.js && tsc --emitDeclarationOnly -p tsconfig.json && yarn package",clean:"shx rm -rf lib/* && shx rm -rf es/*","build:min.js":"webpack",version:"yarn build"},gitHead:m="cc999e430ebfb1dd821783f7cf099ddd51f3495a"}}},function(){return z&&(J=(0,z[L(z)[0]])(z=0)),J}),F=function(e){(0,x.Z)(n,e);var t=(0,Z.Z)(n);function n(e,r,i){var a;return(0,k.Z)(this,n),(a=t.call(this,r)).code=e,a.message=r,a.data=i,a.code=e,a.message=r,a.data=i,a}return(0,w.Z)(n,null,[{key:"userRejectedRequest",value:function(){return new n(4001,"The user rejected the request")}},{key:"userCancelOperation",value:function(){return new n(4011,"The user cancel the operation")}},{key:"unauthorized",value:function(){return new n(4100,"The requested method and/or account has not been authorized by the user")}},{key:"unsupportedMethod",value:function(){return new n(4200,"The Provider does not support the requested method")}},{key:"unsupportedChain",value:function(){return new n(4201,"The Provider does not support the chain")}},{key:"disconnected",value:function(){return new n(4900,"The Provider is disconnected from all chains")}},{key:"chainDisconnected",value:function(){return new n(4901,"The Provider is not connected to the requested chain")}},{key:"paramsError",value:function(){return new n(8002,"Param error, see doc for more info")}}]),n}((0,_.Z)(Error)),G=(0,w.Z)((function e(){(0,k.Z)(this,e)})),Q=function(e){(0,x.Z)(n,e);var t=(0,Z.Z)(n);function n(){var e;return(0,k.Z)(this,n),(e=t.apply(this,arguments)).events=new q.EventEmitter,e}return(0,w.Z)(n,[{key:"on",value:function(e,t){return this.events.on(e,t),this}},{key:"once",value:function(e,t){return this.events.once(e,t),this}},{key:"off",value:function(e,t){return this.events.off(e,t),this}},{key:"removeListener",value:function(e,t){return this.events.removeListener(e,t),this}}]),n}(G),X=function(e){(0,x.Z)(n,e);var t=(0,Z.Z)(n);function n(){var e;return(0,k.Z)(this,n),(e=t.apply(this,arguments)).events=new q.EventEmitter,e}return(0,w.Z)(n,[{key:"on",value:function(e,t){return this.events.on(e,t),this}},{key:"once",value:function(e,t){return this.events.once(e,t),this}},{key:"off",value:function(e,t){return this.events.off(e,t),this}},{key:"removeListener",value:function(e,t){return this.events.removeListener(e,t),this}}]),n}(G),Y=["eth_signTransaction","eth_sign","eth_sendRawTransaction"],$=["eth_requestAccounts","eth_accounts","eth_chainId","eth_sendTransaction","eth_signTypedData","eth_signTypedData_v1","eth_signTypedData_v3","eth_signTypedData_v4","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_watchAsset"],ee=["personal_sign_uniq","eth_signTypedData_v4_uniq"],te=function(){function e(t){(0,k.Z)(this,e),this.auth=t,this.auth=t}return(0,w.Z)(e,[{key:"request",value:function(e){return K(this,null,(0,b.Z)().mark((function t(){var n,r,i,a,s,u;return(0,b.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("eth_requestAccounts"!==e.method&&"eth_accounts"!==e.method){t.next=14;break}if(!(n=this.auth.getWallet())){t.next=4;break}return t.abrupt("return",[n.public_address]);case 4:return t.next=6,this.auth.login();case 6:if(!(n=this.auth.getWallet())){t.next=11;break}return t.abrupt("return",[n.public_address]);case 11:throw new Error("Create wallet failed");case 12:case 29:case 39:case 49:case 57:case 71:t.next=74;break;case 14:if("eth_chainId"!==e.method){t.next=18;break}return t.abrupt("return",(0,C.I4)(this.auth.getChainId()));case 18:if("eth_sendTransaction"!==e.method){t.next=31;break}if(!(e.params&&e.params instanceof Array&&e.params[0])){t.next=28;break}return r=e.params[0],(0,C.Rw)(r.type)&&(I.p5.isChainSupportEIP1559(this.auth.getChain())?r.type="0x2":r.type="0x0"),(0,C.Rw)(r.chainId)&&(r.chainId=(0,C.I4)(this.auth.getChainId())),(0,C.Rw)(r.nonce)&&(r.nonce="0x0"),(0,C.Rw)(r.data)&&(r.data="0x"),t.abrupt("return",this.auth.sendTransaction(this.legacyToString(e.params[0])));case 28:case 38:case 48:case 56:case 70:return t.abrupt("return",Promise.reject(F.paramsError()));case 31:if("eth_signTypedData_v3"!==e.method&&"eth_signTypedData_v4"!==e.method&&"eth_signTypedData_v4_uniq"!==e.method){t.next=41;break}if(!(e.params&&e.params instanceof Array&&e.params.length>=2)){t.next=38;break}return"string"!==typeof(i=e.params[1])||i.startsWith("0x")||(i=(0,C.L_)(T.Buffer.from(i).toString("hex"))),t.abrupt("return",this.auth.sign(e.method,this.legacyToString(i)));case 41:if("eth_signTypedData"!==e.method&&"eth_signTypedData_v1"!==e.method){t.next=51;break}if(!(e.params&&e.params instanceof Array&&e.params[0])){t.next=48;break}return"string"!==typeof(a=e.params[0])||a.startsWith("0x")||(a=(0,C.L_)(T.Buffer.from(a).toString("hex"))),t.abrupt("return",this.auth.sign(e.method,this.legacyToString(a)));case 51:if("personal_sign"!==e.method&&"personal_sign_uniq"!==e.method){t.next=59;break}if(!(e.params&&e.params instanceof Array&&e.params[0])){t.next=56;break}return t.abrupt("return",this.auth.sign(e.method,this.legacyToString(e.params[0])));case 59:if("wallet_switchEthereumChain"!==e.method){t.next=73;break}if(!(e.params&&e.params instanceof Array&&e.params[0]&&e.params[0].chainId)){t.next=70;break}if(s=Number(e.params[0].chainId),!(u=I.p5.getEVMChainInfoById(s))){t.next=67;break}return t.next=66,this.auth.switchChain(u);case 66:return t.abrupt("return",Promise.resolve(null));case 67:return t.abrupt("return",Promise.reject(F.unsupportedChain()));case 73:return t.abrupt("return",Promise.reject(F.unsupportedMethod()));case 74:case"end":return t.stop()}}),t,this)})))}},{key:"legacyToString",value:function(e){return"number"===typeof e?(0,C.L_)(e.toString(16)):"string"===typeof e?e.toString().startsWith("0x")?e:(0,C.L_)(T.Buffer.from(e).toString("hex")):(0,C.L_)(T.Buffer.from(JSON.stringify(e)).toString("hex"))}}]),e}(),ne=function(e){(0,x.Z)(n,e);var t=(0,Z.Z)(n);function n(e){var r;if((0,k.Z)(this,n),(r=t.call(this)).config=e,r.registering=!1,!(0,C.jK)(e.url))throw new Error("Provided URL is not compatible with HTTP connection: ".concat(e.url));return r.config=e,r}return(0,w.Z)(n,[{key:"connected",get:function(){return"undefined"!==typeof this.api}},{key:"connecting",get:function(){return this.registering}},{key:"open",value:function(){return K(this,null,(0,b.Z)().mark((function e(){return(0,b.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.register();case 2:this.api=e.sent;case 3:case"end":return e.stop()}}),e,this)})))}},{key:"close",value:function(){return K(this,null,(0,b.Z)().mark((function e(){return(0,b.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.onClose();case 1:case"end":return e.stop()}}),e,this)})))}},{key:"send",value:function(e){return K(this,null,(0,b.Z)().mark((function t(){return(0,b.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("undefined"!==typeof this.api){t.next=4;break}return t.next=3,this.register();case 3:this.api=t.sent;case 4:return t.abrupt("return",this.api.post("/",e).then((function(e){return e.data})));case 5:case"end":return t.stop()}}),t,this)})))}},{key:"register",value:function(){return K(this,null,(0,b.Z)().mark((function e(){var t,n,r=this;return(0,b.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.config,(0,C.jK)(t.url)){e.next=3;break}throw new Error("Provided URL is not compatible with HTTP connection: ".concat(t.url));case 3:if(!this.registering){e.next=5;break}return e.abrupt("return",new Promise((function(e,t){r.events.once("open",(function(){if("undefined"===typeof r.api)return t(new Error("HTTP connection is missing or invalid"));e(r.api)}))})));case 5:return this.registering=!0,(n=S.Z.create({baseURL:t.url,timeout:3e4,headers:{Accept:"application/json","Content-Type":"application/json"}})).interceptors.request.use((function(e){var n,r;return e.params||(e.params={}),e.params.chainId=null!=(r=null==(n=e.data)?void 0:n.chainId)?r:t.chainId(),e.params.projectUuid=t.authentication.projectId,e.params.projectKey=t.authentication.clientKey,e}),(function(e){return Promise.reject(e)})),this.onOpen(n),e.abrupt("return",n);case 10:case"end":return e.stop()}}),e,this)})))}},{key:"onOpen",value:function(e){this.api=e,this.registering=!1,this.events.emit("open")}},{key:"onClose",value:function(){this.api=void 0,this.events.emit("close")}}]),n}(Q);var re=function(e){(0,x.Z)(n,e);var t=(0,Z.Z)(n);function n(e){var r;return(0,k.Z)(this,n),(r=t.call(this)).auth=e,r.isParticleNetwork=!0,r.auth=e,r.connection=r.setConnection(),r.authAdapter=new te(r.auth),r.auth.on("chainChanged",(function(e){"Solana"!==e.name&&r.emit("chainChanged",(0,C.I4)(e.id))})),"undefined"!==typeof window&&window.particle&&(window.particle.particleProvider=(0,y.Z)(r)),r}return(0,w.Z)(n,[{key:"version",get:function(){return function(){var e=(V(),W(U));return"web_".concat(e.version)}()}},{key:"setConnection",value:function(){var e=this;return new ne({url:"".concat((0,C.oy)(),"/evm-chain"),basicCredentials:this.auth.basicCredentials(),chainId:function(){return e.auth.getChainId()},authentication:this.auth.config})}},{key:"emit",value:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return(t=this.events).emit.apply(t,[e].concat(r))}},{key:"disconnect",value:function(){return K(this,null,(0,b.Z)().mark((function e(){return(0,b.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.auth.logout());case 1:case"end":return e.stop()}}),e,this)})))}},{key:"enable",value:function(){return K(this,null,(0,b.Z)().mark((function e(){return(0,b.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.request({method:"eth_requestAccounts"}));case 1:case"end":return e.stop()}}),e,this)})))}},{key:"request",value:function(e){return K(this,null,(0,b.Z)().mark((function t(){var n,r,i;return(0,b.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.method&&!Y.includes(e.method)){t.next=2;break}return t.abrupt("return",Promise.reject(F.unsupportedMethod()));case 2:if(this.connection.connected){t.next=5;break}return t.next=5,this.open();case 5:if(i={chainId:Number(this.auth.getChainId()),id:null!=(n=e.id)?n:(0,j.Z)(),jsonrpc:null!=(r=e.jsonrpc)?r:"2.0",method:e.method,params:e.params},!$.includes(e.method)&&!ee.includes(e.method)){t.next=10;break}return t.abrupt("return",this.authAdapter.request(e));case 10:return t.abrupt("return",this.requestStrict(i));case 11:case"end":return t.stop()}}),t,this)})))}},{key:"requestStrict",value:function(e){return K(this,null,(0,b.Z)().mark((function t(){return(0,b.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.connection.send(e).then((function(e){return e.error?Promise.reject(e.error):Promise.resolve(e.result)})));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"open",value:function(){return K(this,null,(0,b.Z)().mark((function e(){var t=this;return(0,b.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.connection.open();case 2:this.connection.on("close",(function(){return t.emit("disconnect")})),this.emit("connect",{chainId:(0,C.I4)(this.auth.getChainId())});case 4:case"end":return e.stop()}}),e,this)})))}},{key:"close",value:function(){return K(this,null,(0,b.Z)().mark((function e(){return(0,b.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.connection.close();case 2:case"end":return e.stop()}}),e,this)})))}}]),n}(X),ie=function(e){(0,x.Z)(n,e);var t=(0,Z.Z)(n);function n(e,r){var i;return(0,k.Z)(this,n),(i=t.call(this)).auth=e,i.signerProvider=r,i.isParticleDelegateProvider=!0,i.connection=i.setConnection(),i.listenEvent(),i}return(0,w.Z)(n,[{key:"listenEvent",value:function(){var e=this.events;this.signerProvider.on("connect",(function(t){return e.emit("connect",t)})),this.signerProvider.on("disconnect",(function(t){return e.emit("disconnect",t)})),this.signerProvider.on("message",(function(t){return e.emit("message",t)})),this.signerProvider.on("chainChanged",(function(t){return e.emit("chainChanged",t)})),this.signerProvider.on("accountsChanged",(function(t){return e.emit("accountsChanged",t)}))}},{key:"setConnection",value:function(){var e=this;return new ne({url:"".concat((0,C.oy)(),"/evm-chain"),basicCredentials:this.auth.basicCredentials(),chainId:function(){var t;return null!=(t=e.chainId)?t:e.auth.getChainId()},authentication:this.auth.config})}},{key:"disconnect",value:function(){return K(this,null,(0,b.Z)().mark((function e(){var t;return(0,b.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this.signerProvider).disconnect||"function"!==typeof t.disconnect){e.next=9;break}return e.prev=2,e.next=5,t.disconnect();case 5:e.next=9;break;case 7:e.prev=7,e.t0=e.catch(2);case 9:case"end":return e.stop()}}),e,this,[[2,7]])})))}},{key:"enable",value:function(){return K(this,null,(0,b.Z)().mark((function e(){var t,n;return(0,b.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this.signerProvider).enable||"function"!==typeof t.enable){e.next=13;break}return e.prev=2,e.next=5,t.enable();case 5:n=e.sent,e.next=13;break;case 8:return e.prev=8,e.t0=e.catch(2),e.next=12,this.request({method:"eth_requestAccounts"});case 12:n=e.sent;case 13:return e.abrupt("return",n);case 14:case"end":return e.stop()}}),e,this,[[2,8]])})))}},{key:"request",value:function(e){return K(this,null,(0,b.Z)().mark((function t(){var n,r,i,a;return(0,b.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.method&&!Y.includes(e.method)){t.next=2;break}return t.abrupt("return",Promise.reject(F.unsupportedMethod()));case 2:if(this.connection.connected){t.next=5;break}return t.next=5,this.open();case 5:if(i={id:null!=(n=e.id)?n:(0,j.Z)(),jsonrpc:null!=(r=e.jsonrpc)?r:"2.0",method:e.method,params:e.params},!$.includes(i.method)&&!this.isParticleSignerMethod(i.method)){t.next=12;break}return t.next=9,this.signerProvider.request(i);case 9:return t.abrupt("return",t.sent);case 12:return t.prev=12,t.t0=Number,t.next=16,this.signerProvider.request({method:"eth_chainId"});case 16:t.t1=t.sent,this.chainId=(0,t.t0)(t.t1),t.next=23;break;case 20:t.prev=20,t.t2=t.catch(12),this.chainId=Number(this.auth.getChainId());case 23:return s=H({},i),u={chainId:this.chainId},a=D(s,A(u)),t.next=26,this.requestStrict(a);case 26:return t.abrupt("return",t.sent);case 27:case"end":return t.stop()}var s,u}),t,this,[[12,20]])})))}},{key:"isParticleSignerMethod",value:function(e){return this.signerProvider.isParticleNetwork&&ee.includes(e)}},{key:"requestStrict",value:function(e){return K(this,null,(0,b.Z)().mark((function t(){return(0,b.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.connection.send(e).then((function(e){return e.error?Promise.reject(e.error):Promise.resolve(e.result)})));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"open",value:function(){return K(this,null,(0,b.Z)().mark((function e(){return(0,b.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.connection.open();case 2:case"end":return e.stop()}}),e,this)})))}}]),n}(X)}}]);
//# sourceMappingURL=982.de806eb5.chunk.js.map